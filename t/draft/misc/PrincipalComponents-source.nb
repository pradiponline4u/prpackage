(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     31696,        800]
NotebookOptionsPosition[     30267,        747]
NotebookOutlinePosition[     30909,        772]
CellTagsIndexPosition[     30866,        769]
WindowTitle->Principal Components - Source
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Principal Components", "Section",
 CellFrame->{{0, 0}, {0, 0}},
 ShowCellBracket->False,
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1: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
FP/69esnAAAAAAAAAAAAwM74B4thROM=
   "], {{0, 0}, {1800, 25}}, {0, 255},
   ColorFunction->RGBColor],
  ImageSize->{1800, 25},
  PlotRange->{{0, 1800}, {0, 25}}]], "Section",
 CellFrame->{{0, 0}, {0, 0}},
 ShowCellBracket->False],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SeedRandom", "[", "sr", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x", ",", "\[Lambda]", ",", "V", ",", "v", ",", "ps", ",", "a", ",", 
        "l1", ",", "l2", ",", "la", ",", "lb", ",", "sdr", ",", "sdg", ",", 
        "sigG", ",", "sigR", ",", "g1", ",", "g2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"md", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "\[Rho]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Rho]", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          "n"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "V"}], "}"}], "=", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{"Covariance", "[", "x", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"V", "/", 
          RowBox[{"(", 
           RowBox[{"Norm", "/@", "V"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ps", "=", 
        RowBox[{"pc", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "#"}], "}"}], "]"}], "&"}],
          "/@", "v"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "#"}], "}"}], "]"}], "&"}],
          "/@", 
         RowBox[{"(", 
          RowBox[{"5", "v"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"-", "#"}]}], "}"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"5", "v"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"la", ",", "lb"}], "}"}], "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"l1", ",", "l2"}], "]"}], ",", "2"}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sdr", ",", "sdg"}], "}"}], "=", 
        RowBox[{"StandardDeviation", "/@", 
         RowBox[{"(", 
          RowBox[{"Transpose", "[", "ps", "]"}], ")"}]}]}], ";", 
       RowBox[{"sigR", "=", 
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<\[Sigma] = ``\>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"sdr", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", "Red", 
           ",", "16", ",", "Bold"}], "]"}]}]}], ";", 
       RowBox[{"sigG", "=", 
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<\[Sigma] = ``\>\"", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"sdg", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
           "Green", ",", "16", ",", "Bold"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"x", ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"PointSize", "\[Rule]", " ", "Small"}], "}"}]}], ",", 
           RowBox[{"Prolog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "Green", ",",
               "la", ",", "Red", ",", "lb"}], "}"}]}], ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Green", ",", 
              RowBox[{"Arrowheads", "[", "0.08", "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "4", "]"}], ",", 
              RowBox[{"First", "[", "a", "]"}], ",", "Red", ",", 
              RowBox[{"Arrowheads", "[", "0.08", "]"}], ",", 
              RowBox[{"AbsoluteThickness", "[", "4", "]"}], ",", 
              RowBox[{"Last", "[", "a", "]"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(X\), \(1\)]\)\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[\(X\), \(2\)]\)\>\""}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<bivariate normal data with Karhunen-Loeve directions\>\""}], 
           ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"400", ",", "400"}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "35"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"g", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"g1", "=", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "v", "]"}], "//", "First"}], ",", 
                 "#"}], "]"}], "&"}], "/@", 
              RowBox[{"First", "[", 
               RowBox[{"Transpose", "[", "ps", "]"}], "]"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "\[Rule]", "Small"}], ",", "Red"}], 
               "}"}]}]}], "]"}]}], ";", 
          RowBox[{"g2", "=", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "v", "]"}], "//", "Last"}], ",", 
                 "#"}], "]"}], "&"}], "/@", 
              RowBox[{"Last", "[", 
               RowBox[{"Transpose", "[", "ps", "]"}], "]"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "\[Rule]", "Small"}], ",", "Green"}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"g1", ",", "g2"}], "}"}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", 
             "\"\<data projected on the Karhunen-Loeve directions\>\""}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(X\), \(1\)]\)\>\"", ",", 
               "\"\<\!\(\*SubscriptBox[\(X\), \(2\)]\)\>\""}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"400", ",", "400"}], "}"}]}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", "40"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"g", "==", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "ps", "]"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "\[Rule]", "Medium"}], ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "\[Rule]", "Medium"}], ",", "Green"}], 
               "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"sigR", ",", "\"\<    \>\"", ",", "sigG"}], "}"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<coordinate index\>\"", ",", "\"\<principal component\>\""}],
              "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"400", ",", "400"}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", "40"}]}], "]"}]}], "]"}]}]}], 
     "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", ",", "1", ",", "\"\<graph\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", " ", "\"\<1\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"3", "\[Rule]", "\"\<3\>\""}]}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "100"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "100", ",", "999"}], "}"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Rho]", ",", "0.6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.9"}], ",", 
       RowBox[{"-", "0.6"}], ",", 
       RowBox[{"-", "0.3"}], ",", "0", ",", "0.3", ",", "0.6", ",", "0.9"}], 
      "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sr", ",", "212", ",", "\"\<random seed\>\""}], "}"}], ",", "1",
      ",", "12345", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"g", ",", "n", ",", "\[Rho]", ",", "sr"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$VersionNumber", "<", "7.9"}], ",", 
        RowBox[{"Get", "[", "\"\<MultivariateStatistics`\>\"", "]"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"md", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"$VersionNumber", "<", "7.9"}], ",", 
         "MultivariateStatistics`MultinormalDistribution", ",", 
         "System`MultinormalDistribution"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pc", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"$VersionNumber", "<", "7.9"}], ",", 
         "MultivariateStatistics`PrincipalComponents", ",", 
         "System`PrincipalComponents"}], "]"}]}]}], ")"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.35696210375764*^9, 3.4656455184305077`*^9, {3.4656458759256907`*^9, 
   3.465645951851864*^9}, {3.4656461429855146`*^9, 3.4656461677742324`*^9}, {
   3.465646248879672*^9, 3.4656462582085915`*^9}, 3.465646344243695*^9, 
   3.4656464061462884`*^9, {3.4656464737731557`*^9, 3.46564648427209*^9}, {
   3.465646533022715*^9, 3.46564654587728*^9}, {3.4656474419332805`*^9, 
   3.465647463873719*^9}, {3.4656475518404784`*^9, 3.465647554025522*^9}, {
   3.465667208650259*^9, 3.4656675540717974`*^9}, {3.4656688980473948`*^9, 
   3.465668924187852*^9}, {3.4656689580782604`*^9, 3.4656689769218893`*^9}, {
   3.465669030765295*^9, 3.465669145108313*^9}, {3.465669194311123*^9, 
   3.4656692187953415`*^9}, {3.4656692609669466`*^9, 
   3.4656692614981933`*^9}, {3.4992211520337076`*^9, 3.499221296258129*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = 1, $CellContext`n$$ = 
    100, $CellContext`sr$$ = 212, $CellContext`\[Rho]$$ = 0.6, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`g$$], 1, "graph"}, {1 -> "1", 2 -> "2", 3 -> "3"}}, {{
       Hold[$CellContext`n$$], 100}, {10, 100, 999}}, {{
       Hold[$CellContext`\[Rho]$$], 0.6}, {-0.9, -0.6, -0.3, 0, 0.3, 0.6, 
       0.9}}, {{
       Hold[$CellContext`sr$$], 212, "random seed"}, 1, 12345, 1}}, 
    Typeset`size$$ = {400., {198., 202.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = False, $CellContext`g$262$$ =
     False, $CellContext`n$263$$ = 0, $CellContext`\[Rho]$264$$ = 
    0, $CellContext`sr$265$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = 1, $CellContext`n$$ = 
        100, $CellContext`sr$$ = 212, $CellContext`\[Rho]$$ = 0.6}, 
      "ControllerVariables" :> {
        Hold[$CellContext`g$$, $CellContext`g$262$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$263$$, 0], 
        Hold[$CellContext`\[Rho]$$, $CellContext`\[Rho]$264$$, 0], 
        Hold[$CellContext`sr$$, $CellContext`sr$265$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (SeedRandom[$CellContext`sr$$]; 
       Module[{$CellContext`x$, $CellContext`\[Lambda]$, $CellContext`V$, \
$CellContext`v$, $CellContext`ps$, $CellContext`a$, $CellContext`l1$, \
$CellContext`l2$, $CellContext`la$, $CellContext`lb$, $CellContext`sdr$, \
$CellContext`sdg$, $CellContext`sigG$, $CellContext`sigR$, $CellContext`g1$, \
$CellContext`g2$}, $CellContext`x$ = RandomReal[
            $CellContext`md[{0, 
             0}, {{1, $CellContext`\[Rho]$$}, {$CellContext`\[Rho]$$, 
               1}}], $CellContext`n$$]; {$CellContext`\[Lambda]$, \
$CellContext`V$} = Eigensystem[
            Covariance[$CellContext`x$]]; $CellContext`v$ = 
          Transpose[$CellContext`V$/Map[
            Norm, $CellContext`V$]]; $CellContext`ps$ = \
$CellContext`pc[$CellContext`x$]; $CellContext`a$ = 
          Map[Arrow[{{0, 0}, #}]& , $CellContext`v$]; $CellContext`l1$ = 
          Map[Line[{{0, 0}, #}]& , 5 $CellContext`v$]; $CellContext`l2$ = 
          Map[Line[{{0, 0}, -#}]& , 
            5 $CellContext`v$]; {$CellContext`la$, $CellContext`lb$} = 
          Transpose[
            Partition[
             Join[$CellContext`l1$, $CellContext`l2$], 
             2]]; {$CellContext`sdr$, $CellContext`sdg$} = 
          Map[StandardDeviation, 
            Transpose[$CellContext`ps$]]; $CellContext`sigR$ = Text[
            Style[
             StringForm["\[Sigma] = ``", 
              NumberForm[$CellContext`sdr$, {4, 3}]], Red, 16, 
             Bold]]; $CellContext`sigG$ = Text[
            Style[
             StringForm["\[Sigma] = ``", 
              NumberForm[$CellContext`sdg$, {4, 3}]], Green, 16, Bold]]; 
         Which[$CellContext`g$$ == 1, 
           
           ListPlot[$CellContext`x$, Frame -> True, Axes -> False, 
            AspectRatio -> 1, PlotStyle -> {PointSize -> Small}, Prolog -> {
              AbsoluteThickness[2], Green, $CellContext`la$, 
              Red, $CellContext`lb$}, Epilog -> {Green, 
              Arrowheads[0.08], 
              AbsoluteThickness[4], 
              First[$CellContext`a$], Red, 
              Arrowheads[0.08], 
              AbsoluteThickness[4], 
              Last[$CellContext`a$]}, 
            FrameLabel -> {
             "\!\(\*SubscriptBox[\(X\), \(1\)]\)", 
              "\!\(\*SubscriptBox[\(X\), \(2\)]\)"}, PlotLabel -> 
            "bivariate normal data with Karhunen-Loeve directions", 
            ImageSize -> {400, 400}, ImagePadding -> 35], $CellContext`g$$ == 
           2, $CellContext`g1$ = ListPlot[
              Map[First[
                 Transpose[$CellContext`v$]] #& , 
               First[
                Transpose[$CellContext`ps$]]], 
              PlotStyle -> {PointSize -> Small, Red}]; $CellContext`g2$ = 
            ListPlot[
              Map[Last[
                 Transpose[$CellContext`v$]] #& , 
               Last[
                Transpose[$CellContext`ps$]]], 
              PlotStyle -> {PointSize -> Small, Green}]; 
           Show[{$CellContext`g1$, $CellContext`g2$}, Axes -> False, Frame -> 
             True, PlotLabel -> 
             "data projected on the Karhunen-Loeve directions", AspectRatio -> 
             1, FrameLabel -> {
              "\!\(\*SubscriptBox[\(X\), \(1\)]\)", 
               "\!\(\*SubscriptBox[\(X\), \(2\)]\)"}, ImageSize -> {400, 400},
              ImagePadding -> 40], $CellContext`g$$ == 3, 
           ListPlot[
            Transpose[$CellContext`ps$], Axes -> False, Frame -> True, 
            PlotStyle -> {{PointSize -> Medium, 
               RGBColor[1, 0, 0]}, {PointSize -> Medium, Green}}, PlotLabel -> 
            Row[{$CellContext`sigR$, "    ", $CellContext`sigG$}], 
            FrameLabel -> {"coordinate index", "principal component"}, 
            ImageSize -> {400, 400}, ImagePadding -> 40]]]), 
      "Specifications" :> {{{$CellContext`g$$, 1, "graph"}, {
         1 -> "1", 2 -> "2", 3 -> "3"}}, {{$CellContext`n$$, 100}, {10, 100, 
         999}}, {{$CellContext`\[Rho]$$, 0.6}, {-0.9, -0.6, -0.3, 0, 0.3, 0.6,
           0.9}}, {{$CellContext`sr$$, 212, "random seed"}, 1, 12345, 1, 
         Appearance -> "Labeled", ControlPlacement -> Top}}, 
      "Options" :> {
       ControlPlacement -> Left, AutorunSequencing -> {1, 2, 3}, 
        TrackedSymbols :> {$CellContext`g$$, $CellContext`n$$, $CellContext`\
\[Rho]$$, $CellContext`sr$$}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{549., {242., 247.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>((If[$VersionNumber < 7.9, 
        Get["MultivariateStatistics`"]]; $CellContext`md = 
       If[$VersionNumber < 7.9, 
         MultivariateStatistics`MultinormalDistribution, 
         MultinormalDistribution]; $CellContext`pc = 
       If[$VersionNumber < 7.9, MultivariateStatistics`PrincipalComponents, 
         PrincipalComponents]); Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->76387686],

Cell[CellGroupData[{

Cell["CAPTION", "Section",
 CellFrame->{{0, 0}, {1, 0}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->12,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[TextData[{
 "The construction of principal components is illustrated. This Demonstration \
considers the case for two variables ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "1"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "2"], TraditionalForm]], "InlineMath"],
 " that are simulated as multivariate normal with zero means, unit variances, \
and theoretical correlation ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]], "InlineMath"],
 ". The sample size ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]], "InlineMath"],
 " can be 10, 100, or 999, and there are three graphs."
}], "Text"]
}, Close]]
}, Open  ]],

Cell["\<\
Graph 1: the data is plotted along with the Karhunen\[Dash]Loeve directions\
\>", "Text"],

Cell[TextData[{
 "Graph 2: the data is shown projected on each of the two \
Karhunen\[Dash]Loeve directions; note that there are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "n"}], TraditionalForm]], "InlineMath"],
 " data points"
}], "Text"],

Cell["\<\
Graph 3: the principal components are plotted corresponding to each \
direction; visually, the principal components are the coordinates of the \
projected points in each of the directions\
\>", "Text"],

Cell[CellGroupData[{

Cell["DETAILS", "Section",
 CellFrame->{{0, 0}, {1, 0}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->12,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[TextData[{
 "I. T. Jolliffe, ",
 StyleBox["Principal Component Analysis,",
  FontSlant->"Italic"],
 " 2nd ed., New York: Springer, 2004."
}], "Text"],

Cell[TextData[{
 "T. Hastie, R. Tibshirani, and J. Friedman, ",
 StyleBox["The Elements of Statistical Learning: Data Mining, Inference, and \
Prediction,",
  FontSlant->"Italic"],
 " 2nd ed., New York: Springer, 2009. "
}], "Text"]
}, Close]],

Cell[CellGroupData[{

Cell["THIS NOTEBOOK IS THE SOURCE CODE FROM", "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellMargins->{{48, 10}, {4, 28}},
 CellGroupingRules->{"SectionGrouping", 25},
 CellFrameMargins->{{48, 48}, {6, 5}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->10,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[TextData[{
 "\"",
 ButtonBox["Principal Components",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/PrincipalComponents/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/PrincipalComponents/"],
 "\"",
 " from ",
 ButtonBox["the Wolfram Demonstrations Project",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
 "\[ParagraphSeparator]\[NonBreakingSpace]",
 ButtonBox["http://demonstrations.wolfram.com/PrincipalComponents/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/PrincipalComponents/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/PrincipalComponents/"]
}], "Text",
 CellMargins->{{48, Inherited}, {0, Inherited}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.5]],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Ian McLeod",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Ian+McLeod"], 
    None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Ian+McLeod"]
}], "Text",
 CellDingbat->"\[FilledSmallSquare]",
 CellMargins->{{66, 48}, {2, 4}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.6]],

Cell[CellGroupData[{

Cell[TextData[{
 "A full-function Wolfram ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " system (Version 6 or higher) is required to edit this notebook.\n",
 StyleBox[ButtonBox["GET WOLFRAM MATHEMATICA \[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.wolfram.com/products/mathematica/"], None},
  ButtonNote->"http://www.wolfram.com/products/mathematica/"],
  FontFamily->"Helvetica",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0.42, 0]]
}], "Text",
 CellFrame->True,
 CellMargins->{{48, 68}, {8, 28}},
 CellFrameMargins->12,
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 CellChangeTimes->{3.3750111182355957`*^9},
 ParagraphSpacing->{1., 1.},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.411765],
 Background->RGBColor[1, 1, 1]],

Cell[TextData[{
 "\[Copyright] ",
 StyleBox[ButtonBox["Wolfram Demonstrations Project & Contributors",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Terms of Use",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/termsofuse.html"], None},
  ButtonNote->"http://demonstrations.wolfram.com/termsofuse.html"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Make a new version of this Demonstration \
\[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/participate/upload.jsp?id=\
PrincipalComponents"], None},
  ButtonNote->None],
  FontColor->GrayLevel[0.6]]
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellMargins->{{48, 10}, {20, 50}},
 CellFrameMargins->{{6, 0}, {6, 6}},
 CellFrameColor->GrayLevel[0.6],
 FontFamily->"Verdana",
 FontSize->9,
 FontColor->GrayLevel[0.6]]
}, Open  ]]
}, Open  ]]
},
Editable->True,
Saveable->False,
ScreenStyleEnvironment->"Working",
CellInsertionPointCell->None,
WindowSize->{749, 650},
WindowMargins->{{Inherited, Inherited}, {Inherited, 0}},
WindowElements->{
 "StatusArea", "MemoryMonitor", "MagnificationPopUp", "VerticalScrollBar", 
  "MenuBar"},
WindowTitle->"Principal Components - Source",
DockedCells->{},
CellContext->Notebook,
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[622, 23, 140, 3, 70, "Section"],
Cell[765, 28, 3700, 64, 70, "Section"],
Cell[4468, 94, 13036, 317, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17541, 416, 6847, 132, 70, "Output",
 CellID->76387686],
Cell[CellGroupData[{
Cell[24413, 552, 209, 6, 70, "Section"],
Cell[24625, 560, 654, 18, 70, "Text"]
}, Close]]
}, Open  ]],
Cell[25305, 582, 99, 2, 70, "Text"],
Cell[25407, 586, 242, 7, 70, "Text"],
Cell[25652, 595, 211, 4, 70, "Text"],
Cell[CellGroupData[{
Cell[25888, 603, 209, 6, 70, "Section"],
Cell[26100, 611, 154, 5, 70, "Text"],
Cell[26257, 618, 232, 6, 70, "Text"]
}, Close]],
Cell[CellGroupData[{
Cell[26525, 629, 355, 9, 70, "Text",
 CellGroupingRules->{"SectionGrouping", 25}],
Cell[26883, 640, 892, 24, 70, "Text"],
Cell[27778, 666, 427, 14, 70, "Text"],
Cell[CellGroupData[{
Cell[28230, 684, 815, 24, 70, "Text"],
Cell[29048, 710, 1191, 33, 70, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
(* NotebookSignature HTz9p#fpJtmFPDTxNIF0lqDZ *)
