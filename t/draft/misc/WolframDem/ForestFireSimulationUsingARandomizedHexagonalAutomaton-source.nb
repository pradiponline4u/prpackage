(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     52713,       1198]
NotebookOptionsPosition[     51277,       1144]
NotebookOutlinePosition[     51962,       1170]
CellTagsIndexPosition[     51919,       1167]
WindowTitle->Forest Fire Simulation Using a Randomized Hexagonal Automaton - \
Source
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Forest Fire Simulation Using a Randomized Hexagonal Automaton\
\>", "Section",
 CellFrame->{{0, 0}, {0, 0}},
 ShowCellBracket->False,
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1: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
FP/69esnAAAAAAAAAAAAwM74B4thROM=
   "], {{0, 0}, {1800, 25}}, {0, 255},
   ColorFunction->RGBColor],
  ImageSize->{1800, 25},
  PlotRange->{{0, 1800}, {0, 25}}]], "Section",
 CellFrame->{{0, 0}, {0, 0}},
 ShowCellBracket->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulhexfire", "[", 
   RowBox[{"w_", ",", "r_", ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Clip", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w", "-", 
        RowBox[{"2", "#1"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", "p2", "<", "1"}], ",", 
             RowBox[{"RandomChoice", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "-", "p2"}], ",", "p2"}], "}"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"Dimensions", "[", "w", "]"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"p2", ">", 
                RowBox[{"1", "/", "2"}]}], ",", "1", ",", "0"}], "]"}]}], 
            "]"}], "*", 
           RowBox[{"Sign", "[", "w", "]"}], 
           RowBox[{"CellularAutomaton", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "#1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "#1"}], ")"}]}], "+", 
          RowBox[{"#1", "  ", "2", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", "p1", "<", "1"}], ",", 
             RowBox[{"RandomChoice", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "-", "p1"}], ",", "p1"}], "}"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"Dimensions", "[", "w", "]"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"p1", ">", 
                RowBox[{"1", "/", "2"}]}], ",", "1", ",", "0"}], "]"}]}], 
            "]"}]}]}], ")"}]}], ")"}], "&"}], "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"Sign", "[", "w", "]"}], "-", "w"}], "]"}], ",", 
      RowBox[{"RandomReal", "[", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.35696210375764*^9, 3.3830878847579393`*^9},
 CellID->2092835582],

Cell[BoxData[
 RowBox[{
  RowBox[{"hex", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xym", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xm", "=", 
          RowBox[{"xym", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"ym", "=", 
          RowBox[{"xym", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"2.`", "\[InvisibleSpace]", "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2.`"}], " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"1.`", "\[InvisibleSpace]", "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"1.7320508075688772`", "\[InvisibleSpace]", "-", 
                  RowBox[{"2.`", " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1.`"}], "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"1.7320508075688772`", "\[InvisibleSpace]", "-", 
                  RowBox[{"2.`", " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2.`"}], "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2.`"}], " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1.`"}], "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1.7320508075688772`"}], "-", 
                  RowBox[{"2.`", " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"1.`", "\[InvisibleSpace]", "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1.7320508075688772`"}], "-", 
                  RowBox[{"2.`", " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{"2.`", "\[InvisibleSpace]", "+", 
                  RowBox[{"1.7320508075688772`", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.`", " ", "#1"}], "-", 
                    RowBox[{"1.`", " ", "xm"}], "+", 
                    RowBox[{"2.`", " ", "#2"}], "-", 
                    RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], ")"}]}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2.`"}], " ", "#1"}], "+", "xm", "+", 
                  RowBox[{"2.`", " ", "#2"}], "-", 
                  RowBox[{"1.`", " ", "ym"}]}], ")"}]}]}], "}"}]}], "}"}], 
           "&"}], "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", "xy"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.383087825839828*^9, 3.383087826503518*^9}, {
   3.383087888803726*^9, 3.383087889562768*^9}, 3.383087966594578*^9, {
   3.383088596924259*^9, 3.3830886386146812`*^9}},
 CellID->652972461],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"op1", "\[Equal]", "p1"}], "&&", 
       RowBox[{"op2", "\[Equal]", "p2"}], "&&", 
       RowBox[{"opr", "\[Equal]", "r"}], "&&", 
       RowBox[{"opi", "\[Equal]", "pi"}], "&&", 
       RowBox[{"sr", "\[Equal]", "osr"}], "&&", 
       RowBox[{
        RowBox[{"Dimensions", "[", "w", "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"xy", ",", "xy"}], "}"}]}]}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"SeedRandom", "[", "sr", "]"}], ";", 
       RowBox[{"g", "=", "False"}], ";", 
       RowBox[{"w", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"0", "<", "pi", "<", "1"}], ",", 
              RowBox[{"RandomChoice", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "-", "pi"}], ",", "pi"}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xy", ",", "xy"}], "}"}], "-", "2"}]}], "]"}], ",", 
              
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pi", ">", 
                 RowBox[{"1", "/", "2"}]}], ",", 
                RowBox[{"Array", "[", 
                 RowBox[{
                  RowBox[{"2", "&"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xy", ",", "xy"}], "}"}], "-", "2"}]}], "]"}], 
                ",", 
                RowBox[{"Array", "[", 
                 RowBox[{
                  RowBox[{"1", "&"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xy", ",", "xy"}], "}"}], "-", "2"}]}], "]"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xy", ",", "xy"}], "}"}], "-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"xy", ",", "xy"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"osr", "=", "sr"}], ";", 
       RowBox[{"opi", "=", "pi"}], ";", 
       RowBox[{"opr", "=", "r"}], ";", 
       RowBox[{"op1", "=", "p1"}], ";", 
       RowBox[{"op2", "=", "p2"}], ";", 
       RowBox[{"i", "=", "0"}]}]}], "]"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"Sign", "[", "w", "]"}], "-", "w"}], "]"}], "]"}], "]"}], 
       ">", "0"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"g", "=", "False"}]}], "]"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{"g", ",", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"i", "+", "1"}]}], ";", 
       RowBox[{"w", "=", 
        RowBox[{"rulhexfire", "[", 
         RowBox[{"w", ",", "r", ",", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ";", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"di", "=", 
             RowBox[{
              RowBox[{"Dimensions", "[", "w", "]"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"RGBColor", "[", 
              RowBox[{".31", ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"Polygon", "[", 
                  RowBox[{"hex", "[", 
                   RowBox[{"#", ",", "di", ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"Pi", "/", "4"}], "]"}]}], "]"}], "]"}]}], "]"}], 
               "&"}], "[", 
              RowBox[{"Position", "[", 
               RowBox[{"w", ",", "0"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{".42", ",", ".61", ",", ".08"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"Polygon", "[", 
                  RowBox[{"hex", "[", 
                   RowBox[{"#", ",", "di", ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"Pi", "/", "4"}], "]"}]}], "]"}], "]"}]}], "]"}], 
               "&"}], "[", 
              RowBox[{"Position", "[", 
               RowBox[{"w", ",", "1"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", ".26", ",", "0"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"Polygon", "[", 
                  RowBox[{"hex", "[", 
                   RowBox[{"#", ",", "di", ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"Pi", "/", "4"}], "]"}]}], "]"}], "]"}]}], "]"}], 
               "&"}], "[", 
              RowBox[{"Position", "[", 
               RowBox[{"w", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], "}"}],
         "]"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "i"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"400", ",", "350"}], "}"}]}]}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", ",", "False", ",", "\"\<run\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}], ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"osr", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"opi", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "0"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "102", ",", "\"\<rule of fire spread\>\""}], "}"}], 
     ",", "0", ",", "255", ",", "2", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p2", ",", ".25", ",", "\"\<chance of fire spread\>\""}], "}"}],
      ",", "0", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", ".25", ",", "\"\<chance to continue burning\>\""}], 
      "}"}], ",", "0", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op1", ",", ".25"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op2", ",", ".25"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"opr", ",", "102"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pi", ",", ".0125", ",", "\"\<initial fires\>\""}], "}"}], ",", 
     "0", ",", "1", ",", ".0001", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xy", ",", "31", ",", "\"\<size\>\""}], "}"}], ",", "5", ",", 
     "63", ",", "2", ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Bottom"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sr", ",", "0", ",", "\"\<seed\>\""}], "}"}], ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", "^", "24"}]}], ",", "1", ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "VerticalSlider"}]}], "}"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}], ",", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "12", ",", "14"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.35757176568782*^9, {3.36923182557301*^9, 3.36923183298958*^9}, 
   3.36929299854405*^9, 3.36929593523847*^9, {3.36929704028036*^9, 
   3.36929707346471*^9}, {3.36929711220507*^9, 3.369297182244*^9}, {
   3.36929726407316*^9, 3.36929730489501*^9}, {3.3692974529603*^9, 
   3.36929752332406*^9}, {3.36929761132322*^9, 3.36929763186448*^9}, {
   3.36929769100539*^9, 3.36929779845201*^9}, {3.36929876047468*^9, 
   3.36929876795448*^9}, {3.36929883297576*^9, 3.3692988364688*^9}, {
   3.36929887142922*^9, 3.36929890581317*^9}, {3.36929938699491*^9, 
   3.36929938749104*^9}, {3.36929942770327*^9, 3.3692994941994*^9}, {
   3.36929960091052*^9, 3.36929961122806*^9}, {3.3692998337891*^9, 
   3.36929984924196*^9}, 3.3826921608045073`*^9, 3.382697150406189*^9, 
   3.382722909054044*^9, {3.38272339425815*^9, 3.3827234283654127`*^9}, {
   3.382723549867063*^9, 3.382723551190359*^9}, {3.382723624030702*^9, 
   3.382723660314242*^9}, {3.3827238036215143`*^9, 3.382723833169732*^9}, {
   3.382749178135034*^9, 3.382749186012637*^9}, 3.382750713187091*^9, {
   3.382750783654606*^9, 3.382750789472921*^9}, {3.382864282882798*^9, 
   3.3828643118295937`*^9}, {3.382864457784519*^9, 3.3828644715922127`*^9}, {
   3.382864650438603*^9, 3.3828648378837757`*^9}, {3.382864872787518*^9, 
   3.382865063233418*^9}, {3.3828651870103703`*^9, 3.382865297362732*^9}, {
   3.382865370695859*^9, 3.38286540988659*^9}, {3.382865480117799*^9, 
   3.382865487735867*^9}, {3.382865554303426*^9, 3.382865925746173*^9}, {
   3.382866006097142*^9, 3.382866035389888*^9}, {3.382866095984226*^9, 
   3.382866215314851*^9}, {3.382866304700239*^9, 3.382866413875174*^9}, {
   3.3828664763782673`*^9, 3.382866511974571*^9}, {3.382866567679411*^9, 
   3.38286674477372*^9}, {3.382866778396331*^9, 3.38286679498429*^9}, {
   3.38286682944748*^9, 3.3828668620725946`*^9}, {3.3828668935423326`*^9, 
   3.382866895009981*^9}, {3.382866947288336*^9, 3.3828669644034452`*^9}, {
   3.3828670024891167`*^9, 3.38286705896733*^9}, {3.382902139592885*^9, 
   3.3829021417167473`*^9}, {3.383071030681188*^9, 3.3830710435966063`*^9}, {
   3.383076872798283*^9, 3.383076895113748*^9}, {3.3830878472353992`*^9, 
   3.3830879079487543`*^9}, {3.383088041340097*^9, 3.383088050105937*^9}, {
   3.383088089091308*^9, 3.383088145537837*^9}, {3.383088307387278*^9, 
   3.3830883135829983`*^9}, {3.383088364802725*^9, 3.3830883760082493`*^9}, 
   3.383088422533018*^9, {3.383088682037537*^9, 3.383088771894948*^9}, 
   3.383088864760384*^9, {3.3830889481556377`*^9, 3.383089090167799*^9}, 
   3.38308913653201*^9, {3.383089197915827*^9, 3.383089204718486*^9}, {
   3.385287954694099*^9, 3.385287997586268*^9}, {3.385288116708313*^9, 
   3.385288243323699*^9}, {3.385288358598441*^9, 3.3852883660252037`*^9}, 
   3.3852886417312326`*^9, {3.385293383637128*^9, 3.38529349724724*^9}, {
   3.3853992613411045`*^9, 3.3853992618098545`*^9}, {3.385739233536048*^9, 
   3.3857392398851776`*^9}, {3.385739639800227*^9, 3.3857396591280193`*^9}, 
   3.3857400809445615`*^9, {3.3907369050447693`*^9, 3.390736908279421*^9}, {
   3.390845427790837*^9, 3.390845433308771*^9}, {3.3908455702156334`*^9, 
   3.390845579308709*^9}, {3.3908456723625135`*^9, 3.390845673824616*^9}, {
   3.3908457379067616`*^9, 3.390845769011488*^9}, {3.3908458740425153`*^9, 
   3.3908458742227745`*^9}},
 CellID->1496021318]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`g$$ = False, $CellContext`i$$ = 
    0, $CellContext`op1$$ = 0.25, $CellContext`op2$$ = 
    0.25, $CellContext`opi$$ = 0.1078, $CellContext`opr$$ = 
    102, $CellContext`osr$$ = 0, $CellContext`p1$$ = 0.25, $CellContext`p2$$ =
     0.25, $CellContext`pi$$ = 0.1078, $CellContext`r$$ = 
    102, $CellContext`sr$$ = 0, $CellContext`w$$ = CompressedData["
1:eJyFk1sSgCAIReVupGlLLaENtP+/TAV5mcyU5RG4oJ73c90opRzj2RlVA6jZ
GOSfOm4AQqcxDoYfLGFs7o4g74phlm9zI8PI1zSMBGjsUzvlcw72cwZPxYs3
Un1f3XDecMods4WtOtaDa2Vh5aJrPCXeFEfybQndDcptfLuhvgNmS5IQ2Vkz
3sFTd5CxPuVqd5bnnL1zTX0Wi2vABe4u6AsFPQWC
    "], $CellContext`xy$$ = 31, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`g$$], False, "run"}, {False, True}}, {{
       Hold[$CellContext`w$$], CompressedData["
1:eJyFk1sSgCAIReVupGlLLaENtP+/TAV5mcyU5RG4oJ73c90opRzj2RlVA6jZ
GOSfOm4AQqcxDoYfLGFs7o4g74phlm9zI8PI1zSMBGjsUzvlcw72cwZPxYs3
Un1f3XDecMods4WtOtaDa2Vh5aJrPCXeFEfybQndDcptfLuhvgNmS5IQ2Vkz
3sFTd5CxPuVqd5bnnL1zTX0Wi2vABe4u6AsFPQWC
       "]}}, {{
       Hold[$CellContext`osr$$], 0}}, {{
       Hold[$CellContext`opi$$], 0.1078}}, {{
       Hold[$CellContext`i$$], 0}}, {{
       Hold[$CellContext`r$$], 102, "rule of fire spread"}, 0, 255, 2}, {{
       Hold[$CellContext`p2$$], 0.25, "chance of fire spread"}, 0, 1}, {{
       Hold[$CellContext`p1$$], 0.25, "chance to continue burning"}, 0, 1}, {{
      
       Hold[$CellContext`op1$$], 0.25}}, {{
       Hold[$CellContext`op2$$], 0.25}}, {{
       Hold[$CellContext`opr$$], 102}}, {{
       Hold[$CellContext`pi$$], 0.1078, "initial fires"}, 0, 1, 0.0001}, {{
       Hold[$CellContext`xy$$], 31, "size"}, 5, 63, 2}, {{
       Hold[$CellContext`sr$$], 0, "seed"}, 0, 16777215, 1}}, 
    Typeset`size$$ = {400., {173., 177.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`g$23790$$ = False, $CellContext`r$23791$$ = 
    0, $CellContext`p2$23792$$ = 0, $CellContext`p1$23793$$ = 
    0, $CellContext`pi$23794$$ = 0, $CellContext`xy$23795$$ = 
    0, $CellContext`sr$23796$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`g$$ = False, $CellContext`i$$ = 
        0, $CellContext`op1$$ = 0.25, $CellContext`op2$$ = 
        0.25, $CellContext`opi$$ = 0.1078, $CellContext`opr$$ = 
        102, $CellContext`osr$$ = 0, $CellContext`p1$$ = 
        0.25, $CellContext`p2$$ = 0.25, $CellContext`pi$$ = 
        0.1078, $CellContext`r$$ = 102, $CellContext`sr$$ = 
        0, $CellContext`w$$ = CompressedData["
1:eJyFk1sSgCAIReVupGlLLaENtP+/TAV5mcyU5RG4oJ73c90opRzj2RlVA6jZ
GOSfOm4AQqcxDoYfLGFs7o4g74phlm9zI8PI1zSMBGjsUzvlcw72cwZPxYs3
Un1f3XDecMods4WtOtaDa2Vh5aJrPCXeFEfybQndDcptfLuhvgNmS5IQ2Vkz
3sFTd5CxPuVqd5bnnL1zTX0Wi2vABe4u6AsFPQWC
         "], $CellContext`xy$$ = 31},
       "ControllerVariables" :> {
        Hold[$CellContext`g$$, $CellContext`g$23790$$, False], 
        Hold[$CellContext`r$$, $CellContext`r$23791$$, 0], 
        Hold[$CellContext`p2$$, $CellContext`p2$23792$$, 0], 
        Hold[$CellContext`p1$$, $CellContext`p1$23793$$, 0], 
        Hold[$CellContext`pi$$, $CellContext`pi$23794$$, 0], 
        Hold[$CellContext`xy$$, $CellContext`xy$23795$$, 0], 
        Hold[$CellContext`sr$$, $CellContext`sr$23796$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> (If[
         And[$CellContext`op1$$ == $CellContext`p1$$, $CellContext`op2$$ == \
$CellContext`p2$$, $CellContext`opr$$ == $CellContext`r$$, $CellContext`opi$$ == \
$CellContext`pi$$, $CellContext`sr$$ == $CellContext`osr$$, 
          Dimensions[$CellContext`w$$] == {$CellContext`xy$$, \
$CellContext`xy$$}], {}, 
         SeedRandom[$CellContext`sr$$]; $CellContext`g$$ = 
          False; $CellContext`w$$ = PadRight[
            PadLeft[
             If[0 < $CellContext`pi$$ < 1, 
              
              RandomChoice[{1 - $CellContext`pi$$, $CellContext`pi$$} -> {1, 
                2}, {$CellContext`xy$$, $CellContext`xy$$} - 2], 
              If[$CellContext`pi$$ > 1/2, 
               Array[2& , {$CellContext`xy$$, $CellContext`xy$$} - 2], 
               Array[
               1& , {$CellContext`xy$$, $CellContext`xy$$} - 
                2]]], {$CellContext`xy$$, $CellContext`xy$$} - 
             1], {$CellContext`xy$$, $CellContext`xy$$}]; $CellContext`osr$$ = \
$CellContext`sr$$; $CellContext`opi$$ = $CellContext`pi$$; $CellContext`opr$$ = \
$CellContext`r$$; $CellContext`op1$$ = $CellContext`p1$$; $CellContext`op2$$ = \
$CellContext`p2$$; $CellContext`i$$ = 0]; If[Total[
           Flatten[
            Abs[Sign[$CellContext`w$$] - $CellContext`w$$]]] > 
         0, {}, $CellContext`g$$ = False]; 
       If[$CellContext`g$$, $CellContext`i$$ = $CellContext`i$$ + 
           1; $CellContext`w$$ = $CellContext`rulhexfire[$CellContext`w$$, \
$CellContext`r$$, {$CellContext`p1$$, $CellContext`p2$$}], {}]; Dynamic[
         Graphics[
          Flatten[{
            With[{$CellContext`di$ = Dimensions[$CellContext`w$$] - 1}, {
              RGBColor[0.31, 0, 0], 
              (If[# == {}, {}, 
               Polygon[
                $CellContext`hex[#, $CellContext`di$, 
                 Tan[Pi/4]]]]& )[
               Position[$CellContext`w$$, 0]], 
              RGBColor[0.42, 0.61, 0.08], 
              (If[# == {}, {}, 
               Polygon[
                $CellContext`hex[#, $CellContext`di$, 
                 Tan[Pi/4]]]]& )[
               Position[$CellContext`w$$, 1]], 
              RGBColor[1, 0.26, 0], 
              (If[# == {}, {}, 
               Polygon[
                $CellContext`hex[#, $CellContext`di$, 
                 Tan[Pi/4]]]]& )[
               Position[$CellContext`w$$, 2]]}]}], 
          PlotLabel -> $CellContext`i$$, ImageSize -> {400, 350}]]), 
      "Specifications" :> {{{$CellContext`g$$, False, "run"}, {False, True}, 
         ControlPlacement -> Left}, {{$CellContext`w$$, CompressedData["
1:eJyFk1sSgCAIReVupGlLLaENtP+/TAV5mcyU5RG4oJ73c90opRzj2RlVA6jZ
GOSfOm4AQqcxDoYfLGFs7o4g74phlm9zI8PI1zSMBGjsUzvlcw72cwZPxYs3
Un1f3XDecMods4WtOtaDa2Vh5aJrPCXeFEfybQndDcptfLuhvgNmS5IQ2Vkz
3sFTd5CxPuVqd5bnnL1zTX0Wi2vABe4u6AsFPQWC
          "]}, ControlType -> 
         None}, {{$CellContext`osr$$, 0}, ControlType -> 
         None}, {{$CellContext`opi$$, 0.1078}, ControlType -> 
         None}, {{$CellContext`i$$, 0}, ControlType -> 
         None}, {{$CellContext`r$$, 102, "rule of fire spread"}, 0, 255, 2, 
         Appearance -> 
         "Labeled"}, {{$CellContext`p2$$, 0.25, "chance of fire spread"}, 0, 
         1, Appearance -> "Labeled"}, 
        Delimiter, {{$CellContext`p1$$, 0.25, "chance to continue burning"}, 
         0, 1, Appearance -> "Labeled"}, {{$CellContext`op1$$, 0.25}, 
         ControlType -> None}, {{$CellContext`op2$$, 0.25}, ControlType -> 
         None}, {{$CellContext`opr$$, 102}, ControlType -> None}, 
        Delimiter, {{$CellContext`pi$$, 0.1078, "initial fires"}, 0, 1, 
         0.0001, Appearance -> "Labeled"}, {{$CellContext`xy$$, 31, "size"}, 
         5, 63, 2, ControlPlacement -> Bottom, Appearance -> 
         "Labeled"}, {{$CellContext`sr$$, 0, "seed"}, 0, 16777215, 1, 
         ControlPlacement -> Left, ControlType -> VerticalSlider}}, 
      "Options" :> {AutorunSequencing -> {1, 12, 14}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{497., {281., 286.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(({$CellContext`rulhexfire[
          Pattern[$CellContext`w, 
           Blank[]], 
          Pattern[$CellContext`r, 
           Blank[]], {
           Pattern[$CellContext`p1, 
            Blank[]], 
           Pattern[$CellContext`p2, 
            Blank[]]}] := Clip[
          ($CellContext`w - 2 # + (If[0 < $CellContext`p2 < 1, 
              RandomChoice[{1 - $CellContext`p2, $CellContext`p2} -> {0, 1}, 
               Dimensions[$CellContext`w]], 
              If[$CellContext`p2 > 1/2, 1, 0]] Sign[$CellContext`w] 
            CellularAutomaton[{$CellContext`r, {
               2, {{0, 1, 1}, {1, 1, 1}, {1, 1, 0}}}, {1, 1}}, #] (1 - #) + # 
            2 If[0 < $CellContext`p1 < 1, 
              RandomChoice[{1 - $CellContext`p1, $CellContext`p1} -> {0, 1}, 
               Dimensions[$CellContext`w]], 
              If[$CellContext`p1 > 1/2, 1, 0]])& )[
           Abs[Sign[$CellContext`w] - $CellContext`w], 
           RandomReal[]], {0, 2}], $CellContext`hex = CompiledFunction[{{
            Blank[Real], 2}, {
            Blank[Real], 1}, 
           Blank[Real]}, {{3, 2, 0}, {3, 1, 1}, {3, 0, 0}, {3, 3, 2}}, {0, 7, 
          12, 0, 12}, {{1, 5}, {7, 1, 0}, {70, 1, 0, 0, 0, 1}, {7, 2, 0}, {70,
            1, 0, 0, 0, 2}, {44, 0, 2}, {7, -1, 4}, {7, 1, 5}, {64, 2, 5, 4, 
           3, 2}, {7, 0, 6}, {11, 6, 3}, {4, 199}, {70, 0, 0, 3, 1, 3}, {7, 1,
            6}, {70, 3, 0, 6, 0, 4}, {70, 0, 0, 3, 1, 3}, {7, 2, 6}, {70, 3, 
           0, 6, 0, 3}, {8, 2., 5}, {8, 1.7320508075688772`, 7}, {
           8, 2., 11}, {21, 11, 4, 11}, {8, 1., 10}, {21, 10, 1, 10}, {24, 10,
            8}, {8, 2., 10}, {21, 10, 3, 10}, {8, 1., 6}, {21, 6, 2, 6}, {24, 
           6, 9}, {18, 11, 8, 10, 9, 11}, {21, 7, 11, 7}, {18, 5, 7, 5}, {21, 
           0, 5, 7}, {8, -2., 5}, {21, 5, 4, 5}, {8, 2., 11}, {21, 11, 3, 
           11}, {8, 1., 8}, {21, 8, 2, 8}, {24, 8, 10}, {18, 5, 1, 11, 10, 
           5}, {21, 0, 5, 11}, {67, 7, 11, 3, 3}, {8, 1., 7}, {
           8, 1.7320508075688772`, 11}, {8, 2., 5}, {21, 5, 4, 5}, {
           8, 1., 10}, {21, 10, 1, 10}, {24, 10, 8}, {8, 2., 10}, {21, 10, 3, 
           10}, {8, 1., 9}, {21, 9, 2, 9}, {24, 9, 6}, {18, 5, 8, 10, 6, 5}, {
           21, 11, 5, 11}, {18, 7, 11, 7}, {21, 0, 7, 11}, {
           8, 1.7320508075688772`, 7}, {8, 2., 5}, {21, 5, 4, 5}, {24, 5, 
           8}, {8, 2., 5}, {21, 5, 3, 5}, {8, 1., 10}, {21, 10, 2, 10}, {24, 
           10, 6}, {18, 7, 8, 1, 5, 6, 7}, {21, 0, 7, 8}, {67, 11, 8, 3, 4}, {
           8, -1., 11}, {8, 1.7320508075688772`, 8}, {8, 2., 7}, {21, 7, 4, 
           7}, {8, 1., 5}, {21, 5, 1, 5}, {24, 5, 6}, {8, 2., 5}, {21, 5, 3, 
           5}, {8, 1., 10}, {21, 10, 2, 10}, {24, 10, 9}, {18, 7, 6, 5, 9, 
           7}, {21, 8, 7, 8}, {18, 11, 8, 11}, {21, 0, 11, 8}, {
           8, 1.7320508075688772`, 11}, {8, 2., 7}, {21, 7, 4, 7}, {24, 7, 
           6}, {8, 2., 7}, {21, 7, 3, 7}, {8, 1., 5}, {21, 5, 2, 5}, {24, 5, 
           9}, {18, 11, 6, 1, 7, 9, 11}, {21, 0, 11, 6}, {67, 8, 6, 3, 5}, {
           8, -2., 8}, {8, 1.7320508075688772`, 6}, {8, 2., 11}, {21, 11, 4, 
           11}, {8, 1., 7}, {21, 7, 1, 7}, {24, 7, 9}, {8, 2., 7}, {21, 7, 3, 
           7}, {8, 1., 5}, {21, 5, 2, 5}, {24, 5, 10}, {18, 11, 9, 7, 10, 
           11}, {21, 6, 11, 6}, {18, 8, 6, 8}, {21, 0, 8, 6}, {8, -2., 8}, {
           21, 8, 4, 8}, {8, 2., 11}, {21, 11, 3, 11}, {8, 1., 9}, {21, 9, 2, 
           9}, {24, 9, 7}, {18, 8, 1, 11, 7, 8}, {21, 0, 8, 11}, {67, 6, 11, 
           3, 6}, {8, -1., 6}, {8, 1.7320508075688772`, 11}, {8, 2., 8}, {21, 
           8, 4, 8}, {8, 1., 7}, {21, 7, 1, 7}, {24, 7, 9}, {8, 2., 7}, {21, 
           7, 3, 7}, {8, 1., 10}, {21, 10, 2, 10}, {24, 10, 5}, {18, 8, 9, 7, 
           5, 8}, {21, 11, 8, 11}, {18, 6, 11, 6}, {21, 0, 6, 11}, {
           8, -1.7320508075688772`, 6}, {8, 2., 8}, {21, 8, 4, 8}, {24, 8, 
           9}, {8, 2., 8}, {21, 8, 3, 8}, {8, 1., 7}, {21, 7, 2, 7}, {24, 7, 
           5}, {18, 6, 9, 1, 8, 5, 6}, {21, 0, 6, 9}, {67, 11, 9, 3, 7}, {
           8, 1., 11}, {8, 1.7320508075688772`, 9}, {8, 2., 6}, {21, 6, 4, 
           6}, {8, 1., 8}, {21, 8, 1, 8}, {24, 8, 5}, {8, 2., 8}, {21, 8, 3, 
           8}, {8, 1., 7}, {21, 7, 2, 7}, {24, 7, 10}, {18, 6, 5, 8, 10, 6}, {
           21, 9, 6, 9}, {18, 11, 9, 11}, {21, 0, 11, 9}, {
           8, -1.7320508075688772`, 11}, {8, 2., 6}, {21, 6, 4, 6}, {24, 6, 
           5}, {8, 2., 6}, {21, 6, 3, 6}, {8, 1., 8}, {21, 8, 2, 8}, {24, 8, 
           10}, {18, 11, 5, 1, 6, 10, 11}, {21, 0, 11, 5}, {67, 9, 5, 3, 8}, {
           8, 2., 9}, {8, 1.7320508075688772`, 5}, {8, 2., 11}, {21, 11, 4, 
           11}, {8, 1., 6}, {21, 6, 1, 6}, {24, 6, 10}, {8, 2., 6}, {21, 6, 3,
            6}, {8, 1., 8}, {21, 8, 2, 8}, {24, 8, 7}, {18, 11, 10, 6, 7, 
           11}, {21, 5, 11, 5}, {18, 9, 5, 9}, {21, 0, 9, 5}, {8, -2., 9}, {
           21, 9, 4, 9}, {8, 2., 11}, {21, 11, 3, 11}, {8, 1., 10}, {21, 10, 
           2, 10}, {24, 10, 6}, {18, 9, 1, 11, 6, 9}, {21, 0, 9, 11}, {67, 5, 
           11, 3, 10}, {68, 3, 4, 5, 6, 7, 8, 10, 11}, {66, 4, 11, 2}, {5, 3, 
           2, -198}, {2}}, 
          Function[{$CellContext`xy, $CellContext`xym, $CellContext`s}, 
           
           With[{$CellContext`xm = Part[$CellContext`xym, 1], $CellContext`ym = 
             Part[$CellContext`xym, 2]}, 
            
            Map[({{$CellContext`s (2. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s ((-2.) # + \
$CellContext`xm + 2. #2 - 1. $CellContext`ym)}, {$CellContext`s (1. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s (1.7320508075688772` - 
                2. # + $CellContext`xm + 2. #2 - 
                1. $CellContext`ym)}, {$CellContext`s (-1. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s (1.7320508075688772` - 
                2. # + $CellContext`xm + 2. #2 - 
                1. $CellContext`ym)}, {$CellContext`s (-2. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s ((-2.) # + \
$CellContext`xm + 2. #2 - 1. $CellContext`ym)}, {$CellContext`s (-1. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s (-1.7320508075688772` - 
                2. # + $CellContext`xm + 2. #2 - 
                1. $CellContext`ym)}, {$CellContext`s (1. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s (-1.7320508075688772` - 
                2. # + $CellContext`xm + 2. #2 - 
                1. $CellContext`ym)}, {$CellContext`s (2. + 
                1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                  1. $CellContext`ym)), $CellContext`s ((-2.) # + \
$CellContext`xm + 2. #2 - 1. $CellContext`ym)}}& )[
              Part[#, 1], 
              Part[#, 2]]& , $CellContext`xy]]], Evaluate]}; 
      Typeset`initDone$$ = True); ReleaseHold[
       HoldComplete[{$CellContext`rulhexfire[
           Pattern[$CellContext`w, 
            Blank[]], 
           Pattern[$CellContext`r, 
            Blank[]], {
            Pattern[$CellContext`p1, 
             Blank[]], 
            Pattern[$CellContext`p2, 
             Blank[]]}] := Clip[
           ($CellContext`w - 2 # + (If[0 < $CellContext`p2 < 1, 
               
               RandomChoice[{1 - $CellContext`p2, $CellContext`p2} -> {0, 1}, 
                
                Dimensions[$CellContext`w]], 
               If[$CellContext`p2 > 1/2, 1, 0]] Sign[$CellContext`w] 
             CellularAutomaton[{$CellContext`r, {
                2, {{0, 1, 1}, {1, 1, 1}, {1, 1, 0}}}, {1, 1}}, #] (
              1 - #) + # 2 If[0 < $CellContext`p1 < 1, 
               
               RandomChoice[{1 - $CellContext`p1, $CellContext`p1} -> {0, 1}, 
                
                Dimensions[$CellContext`w]], 
               If[$CellContext`p1 > 1/2, 1, 0]])& )[
            Abs[Sign[$CellContext`w] - $CellContext`w], 
            RandomReal[]], {0, 2}], $CellContext`hex = 
          Compile[{{$CellContext`xy, 
              Blank[Real], 2}, {$CellContext`xym, 
              Blank[Real], 1}, {$CellContext`s, 
              Blank[Real]}}, 
            
            With[{$CellContext`xm = 
              Part[$CellContext`xym, 1], $CellContext`ym = 
              Part[$CellContext`xym, 2]}, 
             
             Map[({{$CellContext`s (2. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s ((-2.) # + \
$CellContext`xm + 2. #2 - 1. $CellContext`ym)}, {$CellContext`s (1. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s (1.7320508075688772` - 
                 2. # + $CellContext`xm + 2. #2 - 
                 1. $CellContext`ym)}, {$CellContext`s (-1. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s (1.7320508075688772` - 
                 2. # + $CellContext`xm + 2. #2 - 
                 1. $CellContext`ym)}, {$CellContext`s (-2. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s ((-2.) # + \
$CellContext`xm + 2. #2 - 1. $CellContext`ym)}, {$CellContext`s (-1. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s (-1.7320508075688772` - 
                 2. # + $CellContext`xm + 2. #2 - 
                 1. $CellContext`ym)}, {$CellContext`s (1. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s (-1.7320508075688772` - 
                 2. # + $CellContext`xm + 2. #2 - 
                 1. $CellContext`ym)}, {$CellContext`s (2. + 
                 1.7320508075688772` (2. # - 1. $CellContext`xm + 2. #2 - 
                   1. $CellContext`ym)), $CellContext`s ((-2.) # + \
$CellContext`xm + 2. #2 - 1. $CellContext`ym)}}& )[
               Part[#, 1], 
               Part[#, 2]]& , $CellContext`xy]]]; Null}]]; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->504176776],

Cell[CellGroupData[{

Cell["CAPTION", "Section",
 CellFrame->{{0, 0}, {1, 0}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->12,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell["\<\
In this model, trees catch on fire. With preset chances, these trees can \
either stop or continue burning, and may set their neighboring trees on fire \
according to a cellular automaton rule. The totalistic automaton patterns are \
easiest to see if the probability of spreading is 1. Trees burn forever if \
the chance to continue burning is 1. Click the \"run\" box to start the model.\
\>", "Text"]
}, Close]]
}, Open  ]],

Cell[CellGroupData[{

Cell["THIS NOTEBOOK IS THE SOURCE CODE FROM", "Text",
 CellFrame->{{0, 0}, {0, 0}},
 CellMargins->{{48, 10}, {4, 28}},
 CellGroupingRules->{"SectionGrouping", 25},
 CellFrameMargins->{{48, 48}, {6, 5}},
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 FontFamily->"Helvetica",
 FontSize->10,
 FontWeight->"Bold",
 FontColor->RGBColor[0.597406, 0, 0.0527047]],

Cell[TextData[{
 "\"",
 ButtonBox["Forest Fire Simulation Using a Randomized Hexagonal Automaton",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/\
ForestFireSimulationUsingARandomizedHexagonalAutomaton/"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/\
ForestFireSimulationUsingARandomizedHexagonalAutomaton/"],
 "\"",
 " from ",
 ButtonBox["the Wolfram Demonstrations Project",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
 "\[ParagraphSeparator]\[NonBreakingSpace]",
 ButtonBox["http://demonstrations.wolfram.com/\
ForestFireSimulationUsingARandomizedHexagonalAutomaton/",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/\
ForestFireSimulationUsingARandomizedHexagonalAutomaton/"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/\
ForestFireSimulationUsingARandomizedHexagonalAutomaton/"]
}], "Text",
 CellMargins->{{48, Inherited}, {0, Inherited}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.5]],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Michael Schreiber",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Michael+\
Schreiber"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Michael+Schreiber"]
}], "Text",
 CellDingbat->"\[FilledSmallSquare]",
 CellMargins->{{66, 48}, {2, 4}},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.6],
 CellID->202572579],

Cell[CellGroupData[{

Cell[TextData[{
 "A full-function Wolfram ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " system (Version 6 or higher) is required to edit this notebook.\n",
 StyleBox[ButtonBox["GET WOLFRAM MATHEMATICA \[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.wolfram.com/products/mathematica/"], None},
  ButtonNote->"http://www.wolfram.com/products/mathematica/"],
  FontFamily->"Helvetica",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->RGBColor[1, 0.42, 0]]
}], "Text",
 CellFrame->True,
 CellMargins->{{48, 68}, {8, 28}},
 CellFrameMargins->12,
 CellFrameColor->RGBColor[0.87, 0.87, 0.87],
 CellChangeTimes->{3.3750111182355957`*^9},
 ParagraphSpacing->{1., 1.},
 FontFamily->"Verdana",
 FontSize->10,
 FontColor->GrayLevel[0.411765],
 Background->RGBColor[1, 1, 1]],

Cell[TextData[{
 "\[Copyright] ",
 StyleBox[ButtonBox["Wolfram Demonstrations Project & Contributors",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/"], None},
  ButtonNote->"http://demonstrations.wolfram.com/"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Terms of Use",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/termsofuse.html"], None},
  ButtonNote->"http://demonstrations.wolfram.com/termsofuse.html"],
  FontColor->GrayLevel[0.6]],
 "\[ThickSpace]\[ThickSpace]\[ThickSpace]|\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
 StyleBox[ButtonBox["Make a new version of this Demonstration \
\[RightGuillemet]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/participate/upload.jsp?id=\
ForestFireSimulationUsingARandomizedHexagonalAutomaton"], None},
  ButtonNote->None],
  FontColor->GrayLevel[0.6]]
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellMargins->{{48, 10}, {20, 50}},
 CellFrameMargins->{{6, 0}, {6, 6}},
 CellFrameColor->GrayLevel[0.6],
 FontFamily->"Verdana",
 FontSize->9,
 FontColor->GrayLevel[0.6]]
}, Open  ]]
}, Open  ]]
},
Editable->True,
Saveable->False,
ScreenStyleEnvironment->"Working",
CellInsertionPointCell->None,
WindowSize->{710, 650},
WindowMargins->{{Inherited, Inherited}, {Inherited, 0}},
WindowElements->{
 "StatusArea", "MemoryMonitor", "MagnificationPopUp", "VerticalScrollBar", 
  "MenuBar"},
WindowTitle->"Forest Fire Simulation Using a Randomized Hexagonal Automaton - \
Source",
DockedCells->{},
CellContext->Notebook,
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[665, 24, 189, 5, 70, "Section"],
Cell[857, 31, 3700, 64, 70, "Section"],
Cell[4560, 97, 2964, 80, 70, "Input",
 InitializationCell->True,
 CellID->2092835582],
Cell[7527, 179, 7369, 176, 70, "Input",
 InitializationCell->True,
 CellID->652972461],
Cell[14899, 357, 12926, 304, 70, "Input",
 CellID->1496021318]
}, Open  ]],
Cell[CellGroupData[{
Cell[27862, 666, 18668, 328, 70, "Output",
 CellID->504176776],
Cell[CellGroupData[{
Cell[46555, 998, 209, 6, 70, "Section"],
Cell[46767, 1006, 413, 6, 70, "Text"]
}, Close]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47228, 1018, 355, 9, 70, "Text",
 CellGroupingRules->{"SectionGrouping", 25}],
Cell[47586, 1029, 1126, 31, 70, "Text"],
Cell[48715, 1062, 465, 15, 70, "Text",
 CellID->202572579],
Cell[CellGroupData[{
Cell[49205, 1081, 815, 24, 70, "Text"],
Cell[50023, 1107, 1226, 33, 70, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
(* NotebookSignature 8Qjm5asL61NKUD0D3Ol8Hipy *)
